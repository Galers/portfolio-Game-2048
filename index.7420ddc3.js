!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var t=function(){var t;function a(){var e,t;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),e="createConfetti",t=function(){var e=document.querySelector(".confetti-container"),t=document.createElement("div");t.classList.add("confetti"),t.style.backgroundColor="hsl(".concat(360*Math.random(),", 100%, 50%)"),t.style.left="".concat(100*Math.random(),"vw"),t.style.animationDelay="".concat(Math.random(),"s"),t.style.animationDuration="".concat(2*Math.random()+3,"s"),e.appendChild(t),setTimeout(function(){t.remove()},5e3)},e in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t,this.board=this.getState(),this.score=0,this.gameActive=!1,this.cells=document.querySelectorAll(".field-cell"),this.messageWin=document.querySelector(".message-win"),this.messageLose=document.querySelector(".message-lose"),this.assignDataAttributes()}return t=[{key:"assignDataAttributes",value:function(){this.cells.forEach(function(e,t){e.dataset.row=Math.floor(t/4),e.dataset.col=t%4})}},{key:"moveUp",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnUp(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"moveDown",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnDown(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"moveLeft",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnLeft(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"moveRight",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnRight(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"getScore",value:function(){return this.board.flat().reduce(function(e,t){return e+t},0)}},{key:"getState",value:function(){var t;return((function(t){if(Array.isArray(t))return e(t)})(t=[,,,,])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,a){if(t){if("string"==typeof t)return e(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(){return[,,,,].fill(0)})}},{key:"getRandomTile",value:function(){for(var e=[],t=0;t<4;t++)for(var a=0;a<4;a++)0===this.board[t][a]&&e.push({row:t,col:a});if(e.length){var n=e[Math.floor(Math.random()*e.length)],i=n.row,o=n.col;return this.board[i][o]=.9>Math.random()?2:4,this.animateNewTile(i,o),{row:i,col:o,value:this.board[i][o]}}return null}},{key:"checkWin",value:function(){return this.board.flat().includes(2048)}},{key:"checkLose",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++){if(0===this.board[e][t])return!1;var a=t<3&&this.board[e][t]===this.board[e][t+1],n=e<3&&this.board[e][t]===this.board[e+1][t];if(a||n)return!1}return!0}},{key:"getStatus",value:function(){return this.checkWin()?"win":this.checkLose()?"lose":"playing"}},{key:"checkGameStatus",value:function(){var e=this.getStatus();"win"===e?(this.messageWin.classList.remove("hidden"),this.showWinMessage(),this.showConfetti()):"lose"===e&&(this.messageLose.classList.remove("hidden"),this.showGameOverMessage())}},{key:"addCell",value:function(){var e=this;this.cells.forEach(function(t,a){var n=Math.floor(a/4),i=a%4,o=e.board[n][i];t.className="field-cell"+(o?" field-cell--".concat(o):""),t.textContent=o||"",e.animateAppear(n,i)})}},{key:"deleteCell",value:function(){this.cells.forEach(function(e){e.className="field-cell",e.textContent=""})}},{key:"start",value:function(e){this.gameActive=!0,this.score=0,e.classList.replace("start","restart"),e.textContent="Restart",this.getRandomTile(),this.getRandomTile(),this.addCell(),this.assignDataAttributes()}},{key:"restart",value:function(e){this.gameActive=!1,this.score=0;var t=this.messageLose.classList.contains("hidden"),a=this.messageWin.classList.contains("hidden");t||this.messageLose.classList.add("hidden"),a||this.messageWin.classList.add("hidden"),e.classList.replace("restart","start"),e.textContent="Start",this.board=this.getState(),this.deleteCell(),this.assignDataAttributes()}},{key:"moveColumnUp",value:function(e){for(var t=!1,a=this.board.map(function(t){return t[e]}).filter(function(e){return 0!==e}),n=0;n<a.length-1;n++)a[n]===a[n+1]&&(a[n]*=2,a.splice(n+1,1),this.score+=a[n],this.animateMerge(n,e),t=!0);for(;a.length<4;)a.push(0);for(var i=0;i<4;i++)this.board[i][e]!==a[i]&&(t=!0),this.board[i][e]=a[i],this.animateMove(i,e);return t}},{key:"moveColumnDown",value:function(e){for(var t=!1,a=this.board.map(function(t){return t[e]}).filter(function(e){return 0!==e}),n=a.length-1;n>0;n--)a[n]===a[n-1]&&(a[n]*=2,a.splice(n-1,1),this.score+=a[n],this.animateMerge(n,e),t=!0);for(;a.length<4;)a.unshift(0);for(var i=0;i<4;i++)this.board[i][e]!==a[i]&&(t=!0),this.board[i][e]=a[i],this.animateMove(i,e);return t}},{key:"moveColumnLeft",value:function(e){for(var t=!1,a=this.board[e].filter(function(e){return 0!==e}),n=0;n<a.length-1;n++)a[n]===a[n+1]&&(a[n]*=2,a.splice(n+1,1),this.score+=a[n],this.animateMerge(e,n),t=!0);for(;a.length<4;)a.push(0);this.board[e].some(function(e,t){return e!==a[t]})&&(t=!0),this.board[e]=a;for(var i=0;i<4;i++)this.animateMove(e,i);return t}},{key:"moveColumnRight",value:function(e){for(var t=!1,a=this.board[e].filter(function(e){return 0!==e}),n=a.length-1;n>0;n--)a[n]===a[n-1]&&(a[n]*=2,a.splice(n-1,1),this.score+=a[n],this.animateMerge(e,n),t=!0);for(;a.length<4;)a.unshift(0);this.board[e].some(function(e,t){return e!==a[t]})&&(t=!0),this.board[e]=a;for(var i=0;i<4;i++)this.animateMove(e,i);return t}},{key:"animateNewTile",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--new"),setTimeout(function(){a.classList.remove("field-cell--new")},300))}},{key:"animateAppear",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--appear"),setTimeout(function(){a.classList.remove("field-cell--appear")},200))}},{key:"animateMerge",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--merge"),setTimeout(function(){a.classList.remove("field-cell--merge")},300))}},{key:"animateMove",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--move"),setTimeout(function(){a.classList.remove("field-cell--move")},300))}},{key:"showGameOverMessage",value:function(){var e=document.querySelector(".game-over-overlay");e.classList.remove("hidden"),setTimeout(function(){e.classList.add("show")},10),setTimeout(function(){e.classList.remove("show"),setTimeout(function(){e.classList.add("hidden")},1e3)},3e3)}},{key:"showWinMessage",value:function(){var e=document.querySelector(".win-overlay");e.classList.remove("hidden"),setTimeout(function(){e.classList.add("show")},10),setTimeout(function(){e.classList.remove("show"),setTimeout(function(){e.classList.add("hidden")},1e3)},3e3)}},{key:"showConfetti",value:function(){for(var e=0;e<100;e++)this.createConfetti()}}],function(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(a.prototype,t),a}();document.addEventListener("DOMContentLoaded",function(){var e=new t,a=document.querySelector(".button"),n=document.querySelector(".game-score"),i=document.querySelector(".message-start"),o=function(){return window.addEventListener("keydown",s,{once:!0})},r=function(){n.textContent=e.getScore()},s=function(t){switch(t.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;default:o();return}r(),o()};o(),a.addEventListener("click",function(){if(a.classList.contains("start"))e.start(a),i.classList.add("hidden");else{if(!confirm("Are you sure you want to start a new game? All progress will be lost."))return;e.restart(a),e.start(a)}r(),o()})})}();
//# sourceMappingURL=index.7420ddc3.js.map
